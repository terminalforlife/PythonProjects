#!/usr/bin/env python3.6

#------------------------------------------------------------------------------
# Project Name      - PythonProjects/source/cve-bash-tsc.py
# Started On        - Thu  8 Jun 16:40:52 BST 2023
# Last Change       - Thu  8 Jun 17:43:49 BST 2023
# Author E-Mail     - terminalforlife@yahoo.com
# Author GitHub     - https://github.com/terminalforlife
#------------------------------------------------------------------------------
# Print a dynamically-sized table with the contents of a BASH CVE TSV file.
#
# I know there are libraries for this, but I prefer to do these things myself.
# Especially when learning the ropes of a language. Even if I weren't, I'd
# probably still do it myself, because I'm not faffing about with the Python
# dependency/version situation anymore than I have to!
#
# Parses raw TSV data found via:
#
#   https://www.cvedetails.com
#------------------------------------------------------------------------------

import sys

try:
	File = sys.argv[1]
except IndexError:
	exit(1)

try:
	Rows = []
	MaxLens = []
	with open(File, 'rt') as FH:
		First = True
		for Line in FH.readlines():
			Line = Line.rstrip()

			if First:
				Line = Line.upper().split("\t")

				for Column in Line:
					MaxLens.append(len(Column))

				First = False
			else:
				Line = Line.split("\t")

				Pos = 0
				for Column in Line:
					if Pos > 14: break

					Len = len(Column)
					if Len > MaxLens[Pos]:
						MaxLens[Pos] = Len

					Pos += 1

			Rows.append(Line)
except FileNotFoundError:
	exit(2)
except PermissionError:
	exit(2)

for Row in Rows:
	Pos = 0
	for Column in Row:
		if Pos > 14:
			print()
			break

		print('%-*s ' % (MaxLens[Pos], Column), end = '')

		Pos += 1
